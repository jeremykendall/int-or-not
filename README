Code and tests from a CSI: PHP post, as yet unposted.  No peeking!
